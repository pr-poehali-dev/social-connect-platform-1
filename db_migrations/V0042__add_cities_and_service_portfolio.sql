-- Создаем таблицу городов
CREATE TABLE IF NOT EXISTS cities (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL UNIQUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Добавляем популярные города России
INSERT INTO cities (name) VALUES
  ('Москва'),
  ('Санкт-Петербург'),
  ('Новосибирск'),
  ('Екатеринбург'),
  ('Казань'),
  ('Нижний Новгород'),
  ('Челябинск'),
  ('Самара'),
  ('Омск'),
  ('Ростов-на-Дону'),
  ('Уфа'),
  ('Красноярск'),
  ('Воронеж'),
  ('Пермь'),
  ('Волгоград'),
  ('Краснодар'),
  ('Саратов'),
  ('Тюмень'),
  ('Тольятти'),
  ('Ижевск'),
  ('Барнаул'),
  ('Ульяновск'),
  ('Иркутск'),
  ('Хабаровск'),
  ('Ярославль'),
  ('Владивосток'),
  ('Махачкала'),
  ('Томск'),
  ('Оренбург'),
  ('Кемерово'),
  ('Новокузнецк'),
  ('Рязань'),
  ('Астрахань'),
  ('Набережные Челны'),
  ('Пенза'),
  ('Киров'),
  ('Липецк'),
  ('Чебоксары'),
  ('Калининград'),
  ('Тула'),
  ('Курск'),
  ('Сочи'),
  ('Ставрополь'),
  ('Улан-Удэ'),
  ('Тверь'),
  ('Магнитогорск'),
  ('Иваново'),
  ('Брянск'),
  ('Белгород'),
  ('Сургут'),
  ('Владимир'),
  ('Нижний Тагил'),
  ('Архангельск'),
  ('Чита'),
  ('Калуга'),
  ('Смоленск'),
  ('Волжский'),
  ('Якутск'),
  ('Саранск'),
  ('Череповец'),
  ('Вологда'),
  ('Владикавказ'),
  ('Мурманск'),
  ('Тамбов'),
  ('Грозный'),
  ('Петрозаводск'),
  ('Кострома'),
  ('Нижневартовск'),
  ('Новороссийск'),
  ('Йошкар-Ола'),
  ('Комсомольск-на-Амуре')
ON CONFLICT (name) DO NOTHING;

-- Создаем таблицу для портфолио услуг
CREATE TABLE IF NOT EXISTS service_portfolio (
  id SERIAL PRIMARY KEY,
  service_id INTEGER NOT NULL,
  image_url TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Индекс для быстрой выборки фото по услуге
CREATE INDEX IF NOT EXISTS idx_service_portfolio_service_id ON service_portfolio(service_id);

-- Добавляем новое поле city_id для связи с cities
ALTER TABLE services ADD COLUMN IF NOT EXISTS city_id INTEGER;

-- Создаем индекс для city_id
CREATE INDEX IF NOT EXISTS idx_services_city_id ON services(city_id);